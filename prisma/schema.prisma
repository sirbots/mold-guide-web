// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id       String    @id @default(auto()) @map("_id") @db.ObjectId
  name     String?
  email    String    @unique
  password String
  reviews  Review[]
  articles Article[]
}

model Doctor {
  id                String   @id @default(auto()) @map("_id") @db.ObjectId
  slug              String   @unique
  published         Boolean  @default(false)
  firstName         String
  middleName        String?
  lastName          String
  gender            String
  practiceName      String?
  phoneNumber       String?
  addressStreet     String?
  addressUnit       String?
  addressCity       String
  addressState      String
  addressZipcode    String?
  addressCountry    String
  website           String?
  telehealth        Boolean?
  shoemakerProtocol Boolean
  conditionsTreated String[] @default(["Mold Illness"])
  certifications    String[] @default([""])
  seesPatientsIn    String[] @default([""])
  bio               String[] @default(["Coming soon!"])
  createdAt         DateTime
  lastModified      DateTime
  reviews           Review[]
}

model Review {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  published Boolean  @default(true)
  title     String
  body      String
  rating    Int
  author    User     @relation(fields: [authorId], references: [id])
  authorId  String   @db.ObjectId
  Doctor    Doctor?  @relation(fields: [doctorId], references: [id])
  doctorId  String
  createdAt DateTime @default(now())
}

view EnrichedReviews {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  title      String
  body       String
  rating     Int
  authorId   String   @db.ObjectId
  authorName String
  doctorId   String
  createdAt  DateTime
}
